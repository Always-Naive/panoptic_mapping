/** Old code from submap merging */

// check whether this submap already exists from past observations
  if (submap_collection->submapIdExists(id_old)) {
    Submap& submap_old = submap_collection->getSubmap(id_old);
    if (!submap_old.is_observed_) {
      // there is an old unobserved map
      submap_old.is_observed_ = true;
      if (submapHasChanged(block_indices,
                           &submap_old,
                           T_M_C,
                           color_image,
                           id_image)) {
        LOG(INFO) << "Old submap " << submap_old.getID() << " ("
                  << submap->getID() << ") has changed.";
      } else {
        LOG(INFO) << "Recognized old submap " << submap_old.getID() << " ("
                  << submap->getID() << ").";
        // since it has not changed replace the current submap with the old one
        //voxblox::mergeLayerAintoLayerB(submap_old.getTsdfLayer(), submap->getTsdfLayerPtr().get());
//        voxblox::BlockIndexList block_list;
//        submap->getTsdfLayer().getAllAllocatedBlocks(&block_list);
//        for (auto &index : block_list){
//          submap->getTsdfLayerPtr()->getBlockByIndex(index).updated().set();
//        }
        submap_old.was_merged_ = true;
        submap_old.remesh_fully_ = true;
        submap->remesh_fully_ = true;
        submap->getTsdfLayerPtr() = submap_old.getTsdfLayerPtr();
        return;
      }
    }
  }



# Setup Airsim
roslaunch panoptic_mapping_ros parse_flat_to_airsim.launch
  
# Run semantic labeling
python ~/catkin_ws/src/unreal_airsim/app/tools/compute_infrared_compensation.py -d /home/lukas/Documents/PanopticMapping/Data -c Id_cam

# Save map
rosservice call /panoptic_mapper/save_map "file_path: '/home/lukas/Documents/PanopticMapping/Data/maps/new_run.panmap'" 

# Load map
rosservice call /panoptic_mapper/load_map "file_path: '/home/lukas/Documents/PanopticMapping/Data/maps/run1.panmap'" 

# Set Visualization Mode
rosservice call /panoptic_mapper/set_visualization_mode "file_path: 'all'" 
rosservice call /panoptic_mapper/set_color_mode "file_path: 'submaps'" 

